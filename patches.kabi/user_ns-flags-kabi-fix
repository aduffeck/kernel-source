From: Takashi Iwai <tiwai@suse.de>
Subject: kABI fix for addition of user_namespace.flags field
Patch-mainline: Never, openSUSE-13.2 only
References: bnc#965308, bnc#965356

The patch 0002-userns-Add-a-knob-to-disable-setgroups-on-a-per-user.patch
introduced the new field to struct user_namespace, and this breaks kABI.
As usual, move this at tail and protect with #ifndef __GENKSYMS__.

Signed-off-by: Takashi Iwai <tiwai@suse.de>

---
 include/linux/user_namespace.h |    4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

--- a/include/linux/user_namespace.h
+++ b/include/linux/user_namespace.h
@@ -31,13 +31,15 @@ struct user_namespace {
 	kuid_t			owner;
 	kgid_t			group;
 	unsigned int		proc_inum;
-	unsigned long		flags;
 
 	/* Register of per-UID persistent keyrings for this namespace */
 #ifdef CONFIG_PERSISTENT_KEYRINGS
 	struct key		*persistent_keyring_register;
 	struct rw_semaphore	persistent_keyring_register_sem;
 #endif
+#ifndef __GENKSYMS__
+	unsigned long		flags;
+#endif
 };
 
 extern struct user_namespace init_user_ns;
